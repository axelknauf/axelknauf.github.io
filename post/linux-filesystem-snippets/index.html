<!DOCTYPE html>

<meta charset="utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta property="og:url" content="https://axelknauf.github.io/">


<meta property="og:type" content="article">
<meta property="og:title" content="Linux snippets &middot; Knowledge Base">

<meta property="og:site_name" content="Knowledge Base">

<title>
    
    Linux snippets
    
</title>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/">
<link rel="stylesheet" href="https://axelknauf.github.io//css/styles.css">
<link rel="stylesheet" href="https://axelknauf.github.io//css/custom.css">


<link rel="shortcut icon" href="https://axelknauf.github.io//assets/favicon.ico">


<link rel="alternate" type="application/rss+xml" title="RSS" href="https://axelknauf.github.io//index.xml">


<div class="container">
    <header class="nav">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="https://axelknauf.github.io/">Knowledge Base</a>
                </div>

                <div class="collapse navbar-collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="https://axelknauf.github.io//post">All Posts</a></li>
                        <li><a href="https://axelknauf.github.io//tags">Tags</a></li>
                        
                        <li><a href="https://axelknauf.github.io/">Welcome</a></li>
                        
                        <li><a href="https://axelknauf.github.io/about/">About</a></li>
                        
                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        
                        
                        
                        
                    </ul>
                </div>
            </div>
        </nav>
    </header>


<div class="row">
    <div class="col-md-8">
        <article class="post">

            <header>
                <div class="post-date">
                    <span class="glyphicon glyphicon-calendar"></span>
                    <time datetime="Dec 20 2015">
                        Dec 20 2015
                    </time>
                </div>
                <h1 class="post-title">
                    <a href="https://axelknauf.github.io/post/linux-filesystem-snippets/">Linux snippets</a>
                </h1>
            </header>

            <div class="post-content">
                

<h3 id="too-many-open-files:39650f4cd9137409ea20052b6865dcd3">&ldquo;Too many open files&rdquo;</h3>

<ul>
<li>check current limit (only valid for executing user): <code>ulimit -a</code> or specifically <code>ulimit -n</code> (<code>-n</code> refers to &ldquo;number of files&rdquo;)</li>
<li>set limit with <code>ulimit -n unlimited</code> or <code>ulimit -n 65535</code> (may result in &ldquo;permission denied&rdquo;)</li>
<li>on Fedora: edit <code>/etc/security/limits.conf</code></li>
</ul>

<h3 id="list-folders-by-size-descending-recursively:39650f4cd9137409ea20052b6865dcd3">List folders by size descending recursively</h3>

<pre><code>    find . -type d -exec du -b {} \; | sort -nr | uniq
</code></pre>

<h3 id="latest-changed-files-one-folder-deep-search:39650f4cd9137409ea20052b6865dcd3">Latest changed files (one folder deep search)</h3>

<pre><code>    find . -maxdepth 2 -type f -exec stat -c %y_%n {} \; | sort -r | less
</code></pre>

<h3 id="10-latest-changed-files-recursively:39650f4cd9137409ea20052b6865dcd3">10 latest changed files (recursively)</h3>

<pre><code>    find . -type f -printf '%TF_%TT %p \n' | sort -r | head -n 10
</code></pre>

<h3 id="change-file-encoding-e-g-from-utf-8:39650f4cd9137409ea20052b6865dcd3">Change file encoding (e. g. from UTF-8)</h3>

<pre><code>    recode -f ascii &lt;file&gt;
</code></pre>

<h3 id="use-kernel-prerouting-to-direct-traffic-from-port-80-to-8080-e-g-for-fronting-tomcat:39650f4cd9137409ea20052b6865dcd3">Use kernel prerouting to direct traffic from port 80 to 8080, e. g. for fronting tomcat</h3>

<pre><code>    iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to-destination :8080
</code></pre>

<h3 id="repeatedly-serve-a-file-using-netcat-call-with-wget-http-localhost-12345:39650f4cd9137409ea20052b6865dcd3">Repeatedly serve a file using netcat (call with wget <a href="http://localhost:12345/">http://localhost:12345/</a>)</h3>

<pre><code>    #!/bin/bash

    while true
    do
      { echo -ne &quot;HTTP/1.0 200 OK\r\nContent-Length: $(wc -c &amp;lt;file.txt)\r\n\r\n&quot;; cat file.txt; } | nc -l 12345
    done

    exit 0
</code></pre>

<h3 id="apply-htdigest-protection-to-apache-directory:39650f4cd9137409ea20052b6865dcd3">Apply htdigest protection to Apache directory</h3>

<h4 id="required-modules:39650f4cd9137409ea20052b6865dcd3">Required modules</h4>

<ul>
<li><code>mod_authz_user</code></li>
<li><code>mod_auth_digest</code></li>
<li><code>mod_authn_file</code></li>
</ul>

<h4 id="configuration:39650f4cd9137409ea20052b6865dcd3">Configuration</h4>

<pre><code>    &lt;Location /path/to/protect&gt;
       AuthType Digest
       AuthName &quot;Protected Area&quot;
       AuthDigestDomain /path/to/protect http://11.22.33.44/path/to/protect
       AuthDigestProvider file
       AuthUserFile /etc/apache2/conf/digest_pw
       Require valid-user
    &lt;/Location&gt;
</code></pre>

<h4 id="create-digest-pw-file:39650f4cd9137409ea20052b6865dcd3">Create digest_pw file</h4>

<pre><code>    htdigest -c /etc/apache2/conf/digest_pw &quot;Protected Area&quot; username
    =&gt; will be asked for password, file created
</code></pre>

<h3 id="upload-multiple-files-via-ftp-which-is-an-interactive-tool:39650f4cd9137409ea20052b6865dcd3">Upload multiple files via FTP (which is an interactive tool)</h3>

<p>Requires curlftpfs and fuse + rsync</p>

<pre><code>    #!/bin/bash

    SOURCE_DIR=./dist/
    HOST=some.host.com
    USER=username
    PASS=passsword
    TARGET_DIR=/target/
    MOUNT_POINT=./mnt/
    TMP_DIR=$(mktemp -d)

    #########################################################################
    ## Abort if mount point does not exist
    if [ ! -d ${MOUNT_POINT} ];
    then
      echo &quot;Target mount point directory does not exist, aborting.&quot;
      exit 1
    fi

    #########################################################################
    ## Mount remote file system locally
    curlftpfs -o user=${USER}:${PASS} ${HOST} ${MOUNT_POINT} || exit 1

    #########################################################################
    ## Transfer files incrementally
    if [ -d &quot;${MOUNT_POINT}/${TARGET_DIR}&quot; ]
    then
        rsync -rtuv --modify-window=1 --delete --no-perms --size-only --temp-dir=${TMP_DIR} ${SOURCE_DIR}/ ${MOUNT_POINT}/${TARGET_DIR}/
    else
        echo &quot;Target remote directory does not exist, aborting.&quot;
    fi

    #########################################################################
    ## Unmount remote file system
    fusermount -u ${MOUNT_POINT}

    #########################################################################
    ## Remove temporary directory
    if [ -d &quot;${TMP_DIR}&quot; ];
    then
        rm -rf ${TMP_DIR}
    fi

    exit 0
</code></pre>

            </div>

            <aside>
                
                <ul class="list-inline post-tags">
                    
                    <li>
                        <a href="https://axelknauf.github.io//tags/linux">
                            <i class="fa fa-tags"></i>
                            linux
                        </a>
                    </li>
                    
                </ul>

                
            
            <footer>

                <nav>
                    <ul class="pager">

                        
                        <li class="previous"><a href="https://axelknauf.github.io/post/oracle-admin-snippets/"><span aria-hidden="true">&larr;</span> Older</a></li>
                        

                        <li><a href="https://axelknauf.github.io//post">All Posts</a></li>

                        
                        <li class="next"><a href="https://axelknauf.github.io/">Newer <span aria-hidden="true">&rarr;</span></a></li>
                        

                    </ul>
                </nav>

                
            </footer>

        </article>
    </div>
    <div class="col-md-4">
        
<aside>
    <div class="row">

        <div class="col-xs-12 col-sm-4 col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Recent Posts</h2>
                </div>
                <div class="list-group">
                    
                    <a href="/post/oracle-admin-snippets/" class="list-group-item">Oracle Administration snippets</a>
                    
                    <a href="/post/linux-filesystem-snippets/" class="list-group-item">Linux snippets</a>
                    
                    <a href="/" class="list-group-item">Welcome</a>
                    
                    <a href="/post/git-svn/" class="list-group-item">Git als SVN Client nutzen</a>
                    
                    <a href="/about/" class="list-group-item">About</a>
                    
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-4 col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Tags</h2>
                </div>
                <div class="list-group">
                    
                    
                    
                    <a href="https://axelknauf.github.io//tags/dba" class="list-group-item">
                        <span class="badge">1</span>
                        dba
                    </a>
                    
                    
                    <a href="https://axelknauf.github.io//tags/git" class="list-group-item">
                        <span class="badge">1</span>
                        git
                    </a>
                    
                    
                    <a href="https://axelknauf.github.io//tags/linux" class="list-group-item">
                        <span class="badge">1</span>
                        linux
                    </a>
                    
                    
                    <a href="https://axelknauf.github.io//tags/oracle" class="list-group-item">
                        <span class="badge">1</span>
                        oracle
                    </a>
                    
                    
                    <a href="https://axelknauf.github.io//tags/svn" class="list-group-item">
                        <span class="badge">1</span>
                        svn
                    </a>
                    
                </div>
            </div>
        </div>

    </div>
</aside>

    </div>
</div>

</div>
<hr>

<footer class="container copy">
    <p>&copy; 2015  Axel Knauf </p>
	<p>Powered by <a href="http://gohugo.io" target="_blank">Hugo</a></p>
	<p>Theme <a href="https://github.com/dim0627/hugo_theme_beg" target="_blank">beg</a> designed by <a href="https://www.facebook.com/daisuke.tsuji.735" target="_blank">Daisuke Tsuji</a></p>
</footer>

<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
document.write('<script src="//sharebutton.net/plugin/sharebutton.php?type=horizontal&u=' + encodeURIComponent(document.location.href) + '"></scr' + 'ipt>');
</script>

